<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrifectaOmni - Real-Time Multi-Asset Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 20px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header .tagline {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
        }

        .opportunities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .opportunity-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .opportunity-section h2 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
        }

        .opportunity-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid;
            transition: transform 0.2s;
        }

        .opportunity-card:hover {
            transform: translateX(5px);
        }

        .opportunity-card.arbitrage {
            border-left-color: #10b981;
        }

        .opportunity-card.forex {
            border-left-color: #3b82f6;
        }

        .opportunity-card.binary {
            border-left-color: #f59e0b;
        }

        .opp-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .opp-title {
            font-size: 1.2em;
            font-weight: bold;
        }

        .opp-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .badge-execute {
            background: #10b981;
            color: white;
        }

        .badge-consider {
            background: #f59e0b;
            color: white;
        }

        .badge-monitor {
            background: #6b7280;
            color: white;
        }

        .badge-strong {
            background: #10b981;
            color: white;
        }

        .badge-moderate {
            background: #3b82f6;
            color: white;
        }

        .badge-weak {
            background: #6b7280;
            color: white;
        }

        .badge-high {
            background: #10b981;
            color: white;
        }

        .badge-low {
            background: #ef4444;
            color: white;
        }

        .opp-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 0.9em;
        }

        .opp-detail {
            display: flex;
            justify-content: space-between;
        }

        .opp-detail .label {
            opacity: 0.8;
        }

        .opp-detail .value {
            font-weight: bold;
        }

        .profit-highlight {
            color: #10b981;
            font-weight: bold;
        }

        .loss-highlight {
            color: #ef4444;
            font-weight: bold;
        }

        .no-opportunities {
            text-align: center;
            padding: 40px;
            opacity: 0.6;
            font-style: italic;
        }

        .connection-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            z-index: 1000;
        }

        .status-connected {
            background: #10b981;
            color: white;
        }

        .status-disconnected {
            background: #ef4444;
            color: white;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .timestamp {
            text-align: center;
            opacity: 0.7;
            margin-top: 20px;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .opportunities-grid {
                grid-template-columns: 1fr;
            }
            
            .opp-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="connection-status status-disconnected" id="connectionStatus">
        üî¥ Connecting...
    </div>

    <div class="container">
        <header>
            <h1>üéØ TrifectaOmni - Real-Time Scanner</h1>
            <p class="tagline">Arbitrage ‚Ä¢ Forex ‚Ä¢ Binary Options Opportunities</p>
        </header>

        <div class="stats-bar">
            <div class="stat-card">
                <div class="label">Arbitrage Opportunities</div>
                <div class="value" id="arbCount">0</div>
            </div>
            <div class="stat-card">
                <div class="label">Forex Opportunities</div>
                <div class="value" id="forexCount">0</div>
            </div>
            <div class="stat-card">
                <div class="label">Binary Options</div>
                <div class="value" id="binaryCount">0</div>
            </div>
            <div class="stat-card">
                <div class="label">Total Scans</div>
                <div class="value" id="totalScans">0</div>
            </div>
            <div class="stat-card">
                <div class="label">Uptime</div>
                <div class="value" id="uptime">0s</div>
            </div>
        </div>

        <div class="opportunities-grid">
            <!-- Arbitrage Opportunities -->
            <div class="opportunity-section">
                <h2>üíé Arbitrage Opportunities</h2>
                <div id="arbitrageOpps"></div>
            </div>

            <!-- Forex Opportunities -->
            <div class="opportunity-section">
                <h2>üí± Forex Trading Signals</h2>
                <div id="forexOpps"></div>
            </div>

            <!-- Binary Options Opportunities -->
            <div class="opportunity-section">
                <h2>‚ö° Binary Options (60s)</h2>
                <div id="binaryOpps"></div>
            </div>
        </div>

        <div class="timestamp" id="lastUpdate">
            Last Update: Never
        </div>
    </div>

    <script>
        let ws;
        let reconnectInterval = 3000;

        function connect() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsUrl = `${protocol}//${window.location.host}/ws`;
            
            ws = new WebSocket(wsUrl);

            ws.onopen = () => {
                console.log('WebSocket connected');
                document.getElementById('connectionStatus').className = 'connection-status status-connected pulse';
                document.getElementById('connectionStatus').textContent = 'üü¢ Live';
            };

            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                updateDashboard(data);
            };

            ws.onerror = (error) => {
                console.error('WebSocket error:', error);
            };

            ws.onclose = () => {
                console.log('WebSocket disconnected. Reconnecting...');
                document.getElementById('connectionStatus').className = 'connection-status status-disconnected';
                document.getElementById('connectionStatus').textContent = 'üî¥ Disconnected';
                
                setTimeout(connect, reconnectInterval);
            };
        }

        function updateDashboard(data) {
            // Update stats
            document.getElementById('arbCount').textContent = data.arbitrage.length;
            document.getElementById('forexCount').textContent = data.forex.length;
            document.getElementById('binaryCount').textContent = data.binary_options.length;
            document.getElementById('totalScans').textContent = data.stats.total_scans;
            document.getElementById('uptime').textContent = data.stats.uptime_formatted;

            // Update arbitrage opportunities
            updateArbitrageOpps(data.arbitrage);

            // Update forex opportunities
            updateForexOpps(data.forex);

            // Update binary options opportunities
            updateBinaryOpps(data.binary_options);

            // Update timestamp
            const timestamp = new Date(data.timestamp).toLocaleString();
            document.getElementById('lastUpdate').textContent = `Last Update: ${timestamp}`;
        }

        function updateArbitrageOpps(opportunities) {
            const container = document.getElementById('arbitrageOpps');
            
            if (opportunities.length === 0) {
                container.innerHTML = '<div class="no-opportunities">‚è≥ Scanning for opportunities...</div>';
                return;
            }

            container.innerHTML = opportunities.map(opp => `
                <div class="opportunity-card arbitrage">
                    <div class="opp-header">
                        <div class="opp-title">${opp.asset} - ${opp.route}</div>
                        <div class="opp-badge ${getBadgeClass(opp.recommendation)}">
                            ${opp.recommendation}
                        </div>
                    </div>
                    <div class="opp-details">
                        ${opp.buy_exchange ? `
                            <div class="opp-detail">
                                <span class="label">Buy:</span>
                                <span class="value">${opp.buy_exchange} @ ${opp.buy_price}</span>
                            </div>
                            <div class="opp-detail">
                                <span class="label">Sell:</span>
                                <span class="value">${opp.sell_exchange} @ ${opp.sell_price}</span>
                            </div>
                        ` : ''}
                        ${opp.buy_chain ? `
                            <div class="opp-detail">
                                <span class="label">Buy Chain:</span>
                                <span class="value">${opp.buy_chain}</span>
                            </div>
                            <div class="opp-detail">
                                <span class="label">Sell Chain:</span>
                                <span class="value">${opp.sell_chain}</span>
                            </div>
                        ` : ''}
                        ${opp.path ? `
                            <div class="opp-detail" style="grid-column: 1 / -1;">
                                <span class="label">Path:</span>
                                <span class="value">${opp.path}</span>
                            </div>
                        ` : ''}
                        <div class="opp-detail">
                            <span class="label">Spread:</span>
                            <span class="value profit-highlight">${opp.spread_pct}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Expected Profit:</span>
                            <span class="value profit-highlight">${opp.expected_profit}</span>
                        </div>
                        ${opp.profit_bps ? `
                            <div class="opp-detail">
                                <span class="label">Profit (bps):</span>
                                <span class="value">${opp.profit_bps}</span>
                            </div>
                        ` : ''}
                        <div class="opp-detail">
                            <span class="label">Capital:</span>
                            <span class="value">${opp.capital_required}</span>
                        </div>
                        ${opp.risk_score ? `
                            <div class="opp-detail">
                                <span class="label">Risk Score:</span>
                                <span class="value">${opp.risk_score}</span>
                            </div>
                        ` : ''}
                        ${opp.execution_time_ms ? `
                            <div class="opp-detail">
                                <span class="label">Execution:</span>
                                <span class="value">${opp.execution_time_ms}ms</span>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function updateForexOpps(opportunities) {
            const container = document.getElementById('forexOpps');
            
            if (opportunities.length === 0) {
                container.innerHTML = '<div class="no-opportunities">‚è≥ Analyzing forex pairs...</div>';
                return;
            }

            container.innerHTML = opportunities.map(opp => `
                <div class="opportunity-card forex">
                    <div class="opp-header">
                        <div class="opp-title">${opp.pair}</div>
                        <div class="opp-badge ${getBadgeClass(opp.recommendation)}">
                            ${opp.recommendation}
                        </div>
                    </div>
                    <div class="opp-details">
                        <div class="opp-detail">
                            <span class="label">Signal:</span>
                            <span class="value ${opp.signal === 'BUY' ? 'profit-highlight' : 'loss-highlight'}">
                                ${opp.signal}
                            </span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Strength:</span>
                            <span class="value">${opp.strength}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Current:</span>
                            <span class="value">${opp.current_price}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Entry:</span>
                            <span class="value">${opp.entry_price}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Take Profit:</span>
                            <span class="value profit-highlight">${opp.take_profit}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Stop Loss:</span>
                            <span class="value loss-highlight">${opp.stop_loss}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">R/R Ratio:</span>
                            <span class="value">${opp.risk_reward_ratio}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Pip Target:</span>
                            <span class="value">${opp.pip_target}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Timeframe:</span>
                            <span class="value">${opp.timeframe}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Confidence:</span>
                            <span class="value">${opp.confidence}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateBinaryOpps(opportunities) {
            const container = document.getElementById('binaryOpps');
            
            if (opportunities.length === 0) {
                container.innerHTML = '<div class="no-opportunities">‚è≥ Searching for high-probability setups...</div>';
                return;
            }

            container.innerHTML = opportunities.map(opp => `
                <div class="opportunity-card binary">
                    <div class="opp-header">
                        <div class="opp-title">${opp.pair}</div>
                        <div class="opp-badge ${getBadgeClass(opp.recommendation)}">
                            ${opp.recommendation}
                        </div>
                    </div>
                    <div class="opp-details">
                        <div class="opp-detail">
                            <span class="label">Direction:</span>
                            <span class="value ${opp.direction === 'CALL' ? 'profit-highlight' : 'loss-highlight'}">
                                ${opp.direction}
                            </span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Expiry:</span>
                            <span class="value">${opp.expiry}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Probability:</span>
                            <span class="value profit-highlight">${opp.probability}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Payout:</span>
                            <span class="value">${opp.payout_ratio}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Current:</span>
                            <span class="value">${opp.current_price}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Predicted:</span>
                            <span class="value">${opp.predicted_price}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Risk:</span>
                            <span class="value loss-highlight">${opp.risk_amount}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Profit:</span>
                            <span class="value profit-highlight">${opp.potential_profit}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Momentum:</span>
                            <span class="value">${opp.momentum}</span>
                        </div>
                        <div class="opp-detail">
                            <span class="label">Volatility:</span>
                            <span class="value">${opp.volatility}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getBadgeClass(recommendation) {
            if (recommendation.includes('EXECUTE') || recommendation.includes('STRONG') || recommendation.includes('HIGH')) {
                return 'badge-execute';
            } else if (recommendation.includes('CONSIDER') || recommendation.includes('MODERATE')) {
                return 'badge-consider';
            } else {
                return 'badge-monitor';
            }
        }

        // Connect on page load
        connect();
    </script>
</body>
</html>
